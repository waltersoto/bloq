(function(u){var q="function";var ab="undefined";var j="bind-to";var i="bind-alternate";var m="load-withThis";var l="load";var k="load-list";var ah="templates";var ag="template";var aa=function(ai){return ai.replace(/^\s+|\s+$/g,"");};var d=function(ai){return(typeof ai==="undefined"||ai===null)?"":ai;};var O=function(ai,aj,ak){return ak.split(ai).join(aj);};var K=function(ai){if(ai.hasChildNodes()){while(ai.childNodes.length>=1){ai.removeChild(ai.firstChild);}}};var ad=function(ai){if(ai.hasOwnProperty("template")&&ai.hasOwnProperty("data")){return(ai.data.constructor===Array);}return false;};var ae=function(ai){return ai.hasOwnProperty("name")&&ai.hasOwnProperty("text");};var Z=function(ai){if(typeof ai!=="undefined"&&ai!==null){return ai.toLowerCase();}return"";};var Y=function(aj){var ai=document.createElement("div");ai.innerHTML=aa(aj);return ai.firstChild;};function G(ai){var aj;if(window.DOMParser){var ak=new DOMParser();aj=ak.parseFromString(ai,"text/xml");}else{aj=new ActiveXObject("Microsoft.XMLDOM");aj.async="false";aj.loadXML(ai);}return aj;}var C=function(ai){var aj=window.onload;if(typeof window.onload!==q){window.onload=ai;}else{if(typeof ai===q){window.onload=function(){if(aj){aj();}ai();};}}};var J=false;var D=null;var I=function(ai){if(typeof D!==q){D=ai;}else{var aj=D;D=function(){if(aj){aj();}ai();};}if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){if(!J){D();J=true;}},false);}else{C(ai);}};var t=function(aj){var al=[];if(aj!==null&&typeof aj!=="undefined"&&aj.constructor===Array){for(var ai=0,ak=aj.length;ai<ak;ai++){if(aj[ai].hasOwnProperty("template")){if(typeof aj[ai].template!=="undefined"&&aj[ai].template!==null){al.push(aj[ai].template);}}}}return al;};var v=function(aj,ai){if(typeof aj==="undefined"||aj===null){return false;}return aj.toLowerCase().split(".").pop()===ai;};var ac=false;var V=[];var af=function(ai,aj){var ak=[];(function(al){for(var am=0,an=al.length;am<an;am++){if(aj(ai[am],am)){ak.push(ai[am]);}}})(ai);return ak;};var x=function(aj){var ai=af(V,function(ak){return ak.name===(ae(aj)?aj.name:aj);});return ai.length>0;};var a=function(ai){if(!x(ai)){V.push(ai);}};var Q=function(ai){(function(aj){aj.onreadystatechange=function(){if(aj.readyState===4){if(aj.responseText.length>0){if(aj.status===200){if(typeof ai.callback===q){ai.callback(aj.responseText);}}else{if(typeof ai.error===q){ai.error(aj.status,aj.statusText);}}}aj=null;}};aj.open("GET",ai.url,true);aj.send(null);})(new XMLHttpRequest());};var n=function(ak,al,aj,ai){if(ak===null||!x(ak)){Q({url:al,callback:function(am){if(typeof aj===q){if(typeof ai==="undefined"){aj(Y(am));}aj(am,ak);}}});}};var P="";var w=false;var X={};var W=function(aj,ai){this.then=function(ak){if(w){if(typeof ak===q){if(typeof ai!=="undefined"){ak(ai);}else{ak();}}}else{if(typeof ak===q){X[aj]=ak;}}};};var b=function(ai){if(ai.constructor===Array){ac=true;}else{ac=false;if(ai.length>0&&ai.substring(ai.length-1)==="\\"){ai=ai.substring(0,ai.length-1);}if(ai.length>0&&ai.substring(ai.length-1)!=="/"){ai=ai+"/";}}P=ai;};var A=function(){this.withThis=function(ap){if(ac){if(P.constructor===Array){if(ap.constructor!==Array){for(var at=0,au=P.length;at<au;at++){if(ae(P[at])){if(P[at].name===ap||ap==="*"){V.push(P[at]);if(ap!=="*"){break;}}}}}else{for(var an=0,ao=ap.length;an<ao;an++){for(var aj=0,ak=P.length;aj<ak;aj++){if(ae(P[aj])){if(P[aj].name===ap[an]){V.push(P[aj]);break;}}}}}}w=V.length>0;if(typeof X[m]===q){X[m]();}}else{if(ap.constructor!==Array&&v(ap,"xml")){n(null,P+ap,function(ay){if(typeof ay!=="undefined"&&ay!==null&&ay.length>0){var aC=G(ay);if(aC.hasChildNodes()&&Z(aC.firstChild.localName)===ah){var aB=aC.firstChild;if(aB.hasChildNodes()){for(var az=0,aA=aB.childNodes.length;az<aA;az++){if(Z(aB.childNodes[az].localName)===ag){var ai=aB.childNodes[az];var aw="generic-"+az;var ax="";if(ai.hasAttributes()){aw=ai.attributes.getNamedItem("name").value;}if(ai.hasChildNodes()){for(var am=0,av=ai.childNodes.length;am<av;am++){if(Z(ai.childNodes[am].nodeName)==="#cdata-section"){ax=ai.childNodes[am].nodeValue;}}}if(ax.length>0){a({name:aw,text:aa(ax)});}}}w=V.length>0;if(typeof X[m]===q){X[m]();}}}}},false);}else{var ar=0;for(var al=0,aq=ap.length;al<aq;al++){n(ap[al],P+ap[al],function(ai,am){a({name:am,text:aa(ai)});ar++;if(ar===aq){w=V.length>0;if(typeof X[m]===q){X[m]();}}},true);}}}return new W(m);};};var z=function(ak,ai){var am=new W(l);var aj=false;if(typeof ai==="undefined"){ai=false;}if(w){var al=af(V,function(an){return an.name===ak;});if(al.length>0){aj=true;am=new W(l,ai?al[0].text:Y(al[0].text));}}if(!aj){n(ak,P+ak,function(an){if(typeof X[l]===q){X[l](ai?an:Y(an));}},ai);}return am;};var B=function(ai){b(ai);return new A();};var f=function(ai){this.alternate=function(al,am){var aj=[];if(al.constructor===Array){var ak=al;if(typeof am!=="undefined"){ak=am;}B(P).withThis(ak).then(function(){var aq=al.length;var an=0;if(ai!==null&&typeof ai!=="undefined"&&aq>0){for(var ao=0,ap=ai.length;ao<ap;ao++){(function(ar){if(an>=aq){an=0;}z(al[an],true).then(function(at){an++;var av=at;for(var au in ai[ar]){if(ai[ar].hasOwnProperty(au)){av=O("{"+au+"}",d(ai[ar][au]),d(av));}}aj.push(Y(av));if(typeof X[i]===q){X[i](aj);}});})(ao);}}});}return new W(i,aj);};this.to=function(al){var aj=[];if(al.constructor===Array){for(var ak=0,am=al.length;ak<am;ak++){z(al[ak],true).then(function(an){if(ai!==null&&typeof ai!=="undefined"){for(var ao=0,ap=ai.length;ao<ap;ao++){var ar=an;for(var aq in ai[ao]){if(ai[ao].hasOwnProperty(aq)){ar=O("{"+aq+"}",d(ai[ao][aq]),d(ar));}}aj.push(Y(ar));}if(typeof X[j]===q){X[j](aj);}}});}}else{z(al,true).then(function(an){if(ai!==null&&typeof ai!=="undefined"){for(var ao=0,ap=ai.length;ao<ap;ao++){var ar=an;for(var aq in ai[ao]){if(ai[ao].hasOwnProperty(aq)){ar=O("{"+aq+"}",d(ai[ao][aq]),d(ar));}}aj.push(Y(ar));}if(typeof X[j]===q){X[j](aj);}}});}return new W(j,aj);};};var e=function(ai){return new f(ai);};var y=function(ai,al){var aj=[];if(typeof ai!=="undefined"&&ai!==null){var ak=t(ai);if(typeof al!=="undefined"){ak=al;}B(P).withThis(ak).then(function(){for(var am=0,an=ai.length;am<an;am++){(function(ao){if(ad(ao)){e(ao.data).to(ao.template).then(function(ar){for(var ap=0,aq=ar.length;ap<aq;ap++){aj.push(ar[ap]);}});}})(ai[am]);}if(typeof X[k]===q){X[k](aj);}});}return new W(k,aj);};var g={ready:I,templates:function(){return V;},fromRepo:function(ai){b(ai);return this;},list:y,loadFrom:B,read:function(ak,aj){if(typeof aj==="undefined"||aj===null){aj={};}var ai=false;if(P===null||typeof P==="undefined"||P.length===0){if(aj.hasOwnProperty("repo")){b(aj.repo);}else{if(aj.hasOwnProperty("repository")){b(aj.repository);}else{P="./";}}}if(aj.hasOwnProperty("asText")){ai=aj.asText;}return z(ak,ai);},bind:e};var c={BLOCK:"bloq-area",PROPERTY:"bloq-field",TEMPLATE:"bloq-template",REPEATER:"bloq-repeat"};var T={INPUT:"input",RADIO:"radio",TEXT_AREA:"textarea",SELECT:"select"};var S="";var R=function(ai,aj){if(ai!==null&&typeof ai!==ab){return ai.querySelectorAll(aj);}return null;};var H=function(an,al,ai){for(var am=0,ao=ai.length;am<ao;am++){var aj=aa(ai[am]);if(an.hasOwnProperty(aj)){if(typeof(an[aj])!==ab){var ak=al.innerHTML;al.innerHTML=O("{"+aj+"}",typeof an[aj]===q?an[aj]():an[aj],ak);}}}};var r=function(ai){var aj=document.querySelectorAll("["+c.BLOCK+"="+ai+"]");if(typeof aj!==ab&&aj!==null&&aj.length>0){return aj[0];}return null;};var s=function(){var ai=r(S);var aj=R(ai,"["+c.PROPERTY+"]");return aj;};var M=function(am,ai,ak){for(var al in ak){if(ak.hasOwnProperty(al)){if(typeof(ak[al])!==ab){var aj=ai.innerHTML;ai.innerHTML=O("{"+al+"}",(typeof ak[al]===q)?ak[al]():ak[al],aj);}}}am.appendChild(ai);};var F=null;var U=null;var E=null;var N=function(ai){this.to=function(ak){if(F===null){F=r(S);}if(F!==null&&typeof F!==ab){if(U===null){var aj=R(F,"["+c.REPEATER+" = "+ak+"]");if(aj.length>0){U=aj[0];}}if(U!==null&&typeof U!==ab){if(E===null){if(U.firstElementChild){E=U.firstElementChild.cloneNode(true);}}K(U);if(ai.constructor===Array){for(var al=0,am=ai.length;al<am;al++){M(U,E.cloneNode(true),ai[al]);}}}}};};var p=function(aj,ai){if(ai.length>0){if(ai.substr(0,1)==="#"){if(ai.indexOf("#UPPER")!==-1){return aj.toUpperCase();}if(ai.indexOf("#LOWER")){return aj.toLowerCase();}}}return O("{0}",aj,ai);};var L=function(ai){return new N(ai);};var o=function(ai){S=ai;this.repeat=L;this.take=function(){var ao={};var al=s(S);if(typeof al!=="undefined"&&al!==null&&al.length>0){for(var aj=0;aj<al.length;aj++){var an=al[aj].attributes.getNamedItem(c.PROPERTY).value;switch(al[aj].tagName.toLowerCase()){case T.TEXT_AREA:case T.INPUT:var ap=al[aj].type;switch(ap.toLowerCase()){case T.RADIO:if(al[aj].checked){ao[an]=al[aj].value;}break;default:ao[an]=al[aj].value;break;}break;case T.SELECT:if(typeof al[aj].selectedIndex!=="undefined"&&al[aj].selectedIndex!==-1){if(al[aj].multiple){var aq=[];for(var am=0,ak=al[aj].length;am<ak;am++){if(al[aj].options[am].selected){aq.push(al[aj].options[am].value);}}ao[an]=aq;}else{ao[an]=al[aj].options[al[aj].selectedIndex].value;}}break;default:if(typeof(al[aj].innerHTML)!=="undefined"){ao[an]=al[aj].innerHTML;}break;}}}return ao;};this.put=function(az){var ao=r(S);if(ao!==null){var aI=ao.querySelectorAll("["+c.TEMPLATE+"]");var aE=[];if(aI.length>0){for(var aH=0,aJ=aI.length;aH<aJ;aH++){var ar=aI[aH].getAttribute(c.TEMPLATE);if(aa(ar)==="*"){aE.push(aI[aH]);}else{var au=ar.split(",");H(az,aI[aH],au);}}}for(var aD in az){if(az.hasOwnProperty(aD)){if(typeof(az[aD])!==ab){for(var ak=0,al=aE.length;ak<al;ak++){var aq=aE[ak].innerHTML;aE[ak].innerHTML=O("{"+aD+"}",(typeof az[aD]===q)?az[aD]():az[aD],aq);}var at=ao.querySelectorAll("["+c.PROPERTY+"="+aD+"]");if(typeof at!==ab&&at.length>0){for(var aw=0,aB=at.length;aw<aB;aw++){var av="";var ap=(typeof az[aD]===q)?az[aD]():az[aD];if(at[aw].getAttribute("bloq-format")){av=at[aw].getAttribute("bloq-format");ap=p(ap,av);}switch(at[aw].tagName.toLowerCase()){case T.TEXT_AREA:case T.INPUT:if(at[aw].type.toLowerCase()===T.RADIO){for(var aF=0,aG=at.length;aF<aG;aF++){if(at[aF].value.toLowerCase()===ap.toLowerCase()){at[aF].checked=true;}}}else{at[aw].value=ap;}break;case T.SELECT:if(az[aD].constructor!==Array){for(var aC=0,aA=at[0].length;aC<aA;aC++){if(at[aw].options[aC].value.toLowerCase()===ap.toLowerCase()){at[aw].options[aC].selected=true;}}}else{for(var ax=0,ay=az[aD].length;ax<ay;ax++){for(var aj=0,an=at[aw].length;aj<an;aj++){if(at[aw].options[aj].value.toLowerCase()===ap.toLowerCase()){at[aw].options[aj].selected=true;}}}}break;default:if(typeof(at[aw].innerHTML)!==ab){at[aw].innerHTML=ap;}break;}}}}}}}return this;};};var h=function(ai){return new o(ai);};h.extend=function(ai){for(var aj in ai){if(ai.hasOwnProperty(aj)){if(typeof(ai[aj])!==ab){h[aj]=ai[aj];}}}};h.extend(g);if(!u.bloq){u.bloq=u.bloq=h;}})(window);