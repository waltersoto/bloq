(function(u){var q="function";var ab="undefined";var j="bind-to";var i="bind-alternate";var m="load-withThis";var l="load";var k="load-list";var ah="templates";var ag="template";var aa=function(ai){return ai.replace(/^\s+|\s+$/g,"");};var d=function(ai){return(typeof ai==="undefined"||ai===null)?"":ai;};var O=function(ai,aj,ak){return ak.split(ai).join(aj);};var K=function(ai){if(ai.hasChildNodes()){while(ai.childNodes.length>=1){ai.removeChild(ai.firstChild);}}};var ad=function(ai){if(ai.hasOwnProperty("template")&&ai.hasOwnProperty("data")){return(ai.data.constructor===Array);}return false;};var ae=function(ai){return ai.hasOwnProperty("name")&&ai.hasOwnProperty("text");};var Z=function(ai){if(typeof ai!=="undefined"&&ai!==null){return ai.toLowerCase();}return"";};var Y=function(aj){var ai=document.createElement("div");ai.innerHTML=aa(aj);return ai.firstChild;};function G(ai){var aj;if(window.DOMParser){var ak=new DOMParser();aj=ak.parseFromString(ai,"text/xml");}else{aj=new ActiveXObject("Microsoft.XMLDOM");aj.async="false";aj.loadXML(ai);}return aj;}var C=function(ai){var aj=window.onload;if(typeof window.onload!==q){window.onload=ai;}else{if(typeof ai===q){window.onload=function(){if(aj){aj();}ai();};}}};var J=false;var D=null;var I=function(ai){if(typeof D!==q){D=ai;}else{var aj=D;D=function(){if(aj){aj();}ai();};}if(document.addEventListener){document.addEventListener("DOMContentLoaded",function(){if(!J){D();J=true;}},false);}else{C(ai);}};var t=function(aj){var al=[];if(aj!==null&&typeof aj!=="undefined"&&aj.constructor===Array){for(var ai=0,ak=aj.length;ai<ak;ai++){if(aj[ai].hasOwnProperty("template")){if(typeof aj[ai].template!=="undefined"&&aj[ai].template!==null){al.push(aj[ai].template);}}}}return al;};var v=function(aj,ai){if(typeof aj==="undefined"||aj===null){return false;}return aj.toLowerCase().split(".").pop()===ai;};var ac=false;var V=[];var af=function(ai,aj){var ak=[];(function(al){for(var am=0,an=al.length;am<an;am++){if(aj(ai[am],am)){ak.push(ai[am]);}}})(ai);return ak;};var x=function(aj){var ai=af(V,function(ak){return ak.name===(ae(aj)?aj.name:aj);});return ai.length>0;};var a=function(ai){if(!x(ai)){V.push(ai);}};var Q=function(ai){(function(aj){aj.onreadystatechange=function(){if(aj.readyState===4){if(aj.responseText.length>0){if(aj.status===200){if(typeof ai.callback===q){ai.callback(aj.responseText);}}else{if(typeof ai.error===q){ai.error(aj.status,aj.statusText);}}}aj=null;}};aj.open("GET",ai.url,true);aj.send(null);})(new XMLHttpRequest());};var n=function(ak,al,aj,ai){if(ak===null||!x(ak)){Q({url:al,callback:function(am){if(typeof aj===q){if(typeof ai==="undefined"){aj(Y(am));}aj(am,ak);}}});}};var P="";var w=false;var X={};var W=function(aj,ai){this.then=function(ak){if(w){if(typeof ak===q){if(typeof ai!=="undefined"){ak(ai);}else{ak();}}}else{if(typeof ak===q){X[aj]=ak;}}};};var b=function(ai){if(ai.constructor===Array){ac=true;}else{ac=false;if(ai.length>0&&ai.substring(ai.length-1)==="\\"){ai=ai.substring(0,ai.length-1);}if(ai.length>0&&ai.substring(ai.length-1)!=="/"){ai=ai+"/";}}P=ai;};var A=function(){this.withThis=function(ap){if(ac){if(P.constructor===Array){if(ap.constructor!==Array){for(var at=0,au=P.length;at<au;at++){if(ae(P[at])){if(P[at].name===ap||ap==="*"){V.push(P[at]);if(ap!=="*"){break;}}}}}else{for(var an=0,ao=ap.length;an<ao;an++){for(var aj=0,ak=P.length;aj<ak;aj++){if(ae(P[aj])){if(P[aj].name===ap[an]){V.push(P[aj]);break;}}}}}}w=V.length>0;if(typeof X[m]===q){X[m]();}}else{if(ap.constructor!==Array&&v(ap,"xml")){n(null,P+ap,function(ay){if(typeof ay!=="undefined"&&ay!==null&&ay.length>0){var aC=G(ay);if(aC.hasChildNodes()&&Z(aC.firstChild.localName)===ah){var aB=aC.firstChild;if(aB.hasChildNodes()){for(var az=0,aA=aB.childNodes.length;az<aA;az++){if(Z(aB.childNodes[az].localName)===ag){var ai=aB.childNodes[az];var aw="generic-"+az;var ax="";if(ai.hasAttributes()){aw=ai.attributes.getNamedItem("name").value;}if(ai.hasChildNodes()){for(var am=0,av=ai.childNodes.length;am<av;am++){if(Z(ai.childNodes[am].nodeName)==="#cdata-section"){ax=ai.childNodes[am].nodeValue;}}}if(ax.length>0){a({name:aw,text:aa(ax)});}}}w=V.length>0;if(typeof X[m]===q){X[m]();}}}}},false);}else{var ar=0;for(var al=0,aq=ap.length;al<aq;al++){n(ap[al],P+ap[al],function(ai,am){a({name:am,text:aa(ai)});ar++;if(ar===aq){w=V.length>0;if(typeof X[m]===q){X[m]();}}},true);}}}return new W(m);};};var z=function(ak,ai){var am=new W(l);var aj=false;if(typeof ai==="undefined"){ai=false;}if(w){var al=af(V,function(an){return an.name===ak;});if(al.length>0){aj=true;am=new W(l,ai?al[0].text:Y(al[0].text));}}if(!aj){n(ak,P+ak,function(an){if(typeof X[l]===q){X[l](ai?an:Y(an));}},ai);}return am;};var B=function(ai){b(ai);return new A();};var f=function(ai){this.alternate=function(al,am){var aj=[];if(al.constructor===Array){var ak=al;if(typeof am!=="undefined"){ak=am;}B(P).withThis(ak).then(function(){var aq=al.length;var an=0;if(ai!==null&&typeof ai!=="undefined"&&aq>0){for(var ao=0,ap=ai.length;ao<ap;ao++){(function(ar){if(an>=aq){an=0;}z(al[an],true).then(function(at){an++;var av=at;for(var au in ai[ar]){if(ai[ar].hasOwnProperty(au)){av=O("{"+au+"}",d(ai[ar][au]),d(av));}}aj.push(Y(av));if(typeof X[i]===q){X[i](aj);}});})(ao);}}});}return new W(i,aj);};this.to=function(al){var aj=[];if(al.constructor===Array){for(var ak=0,am=al.length;ak<am;ak++){z(al[ak],true).then(function(an){if(ai!==null&&typeof ai!=="undefined"){for(var ao=0,ap=ai.length;ao<ap;ao++){var ar=an;for(var aq in ai[ao]){if(ai[ao].hasOwnProperty(aq)){ar=O("{"+aq+"}",d(ai[ao][aq]),d(ar));}}aj.push(Y(ar));}if(typeof X[j]===q){X[j](aj);}}});}}else{z(al,true).then(function(an){if(ai!==null&&typeof ai!=="undefined"){for(var ao=0,ap=ai.length;ao<ap;ao++){var ar=an;for(var aq in ai[ao]){if(ai[ao].hasOwnProperty(aq)){ar=O("{"+aq+"}",d(ai[ao][aq]),d(ar));}}aj.push(Y(ar));}if(typeof X[j]===q){X[j](aj);}}});}return new W(j,aj);};};var e=function(ai){return new f(ai);};var y=function(ai,al){var aj=[];if(typeof ai!=="undefined"&&ai!==null){var ak=t(ai);if(typeof al!=="undefined"){ak=al;}B(P).withThis(ak).then(function(){for(var am=0,an=ai.length;am<an;am++){(function(ao){if(ad(ao)){e(ao.data).to(ao.template).then(function(ar){for(var ap=0,aq=ar.length;ap<aq;ap++){aj.push(ar[ap]);}});}})(ai[am]);}if(typeof X[k]===q){X[k](aj);}});}return new W(k,aj);};var g={ready:I,templates:function(){return V;},fromRepo:function(ai){b(ai);return this;},list:y,loadFrom:B,read:function(ak,aj){if(typeof aj==="undefined"||aj===null){aj={};}var ai=false;if(P===null||typeof P==="undefined"||P.length===0){if(aj.hasOwnProperty("repo")){b(aj.repo);}else{if(aj.hasOwnProperty("repository")){b(aj.repository);}else{P="./";}}}if(aj.hasOwnProperty("asText")){ai=aj.asText;}return z(ak,ai);},bind:e};var c={BLOCK:"bloq-area",PROPERTY:"bloq-field",TEMPLATE:"bloq-template",REPEATER:"bloq-repeat"};var T={INPUT:"input",RADIO:"radio",TEXT_AREA:"textarea",SELECT:"select"};var S="";var R=function(ai,aj){if(ai!==null&&typeof ai!==ab){return ai.querySelectorAll(aj);}return null;};var H=function(an,al,ai){for(var am=0,ao=ai.length;am<ao;am++){var aj=aa(ai[am]);if(an.hasOwnProperty(aj)){if(typeof(an[aj])!==ab){var ak=al.innerHTML;al.innerHTML=O("{"+aj+"}",typeof an[aj]===q?an[aj]():an[aj],ak);}}}};var r=function(ai){var aj=document.querySelectorAll("["+c.BLOCK+"="+ai+"]");if(typeof aj!==ab&&aj!==null&&aj.length>0){return aj[0];}return null;};var s=function(aj){var ai=r(S);var ak=R(ai,"["+aj+"]");return ak;};var M=function(am,ai,ak){for(var al in ak){if(ak.hasOwnProperty(al)){if(typeof(ak[al])!==ab){var aj=ai.innerHTML;ai.innerHTML=O("{"+al+"}",(typeof ak[al]===q)?ak[al]():ak[al],aj);}}}am.appendChild(ai);};var F=null;var U=null;var E=null;var N=function(ai){this.to=function(ak){if(F===null){F=r(S);}if(F!==null&&typeof F!==ab){if(U===null){var aj=R(F,"["+c.REPEATER+" = "+ak+"]");if(aj.length>0){U=aj[0];}}if(U!==null&&typeof U!==ab){if(E===null){if(U.firstElementChild){E=U.firstElementChild.cloneNode(true);}}K(U);if(ai.constructor===Array){for(var al=0,am=ai.length;al<am;al++){M(U,E.cloneNode(true),ai[al]);}}}}};};var p=function(aj,ai){if(ai.length>0){if(ai.substr(0,1)==="#"){if(ai.indexOf("#UPPER")!==-1){return aj.toUpperCase();}if(ai.indexOf("#LOWER")){return aj.toLowerCase();}}}return O("{0}",aj,ai);};var L=function(ai){return new N(ai);};var o=function(ai){S=ai;this.repeat=L;var ak=function(an){var ar={};var ao=s(an);if(typeof ao!=="undefined"&&ao!==null&&ao.length>0){for(var al=0;al<ao.length;al++){var aq=ao[al].attributes.getNamedItem(an).value;switch(ao[al].tagName.toLowerCase()){case T.TEXT_AREA:case T.INPUT:var at=ao[al].type;switch(at.toLowerCase()){case T.RADIO:if(ao[al].checked){ar[aq]=ao[al].value;}break;default:ar[aq]=ao[al].value;break;}break;case T.SELECT:if(typeof ao[al].selectedIndex!=="undefined"&&ao[al].selectedIndex!==-1){if(ao[al].multiple){var au=[];for(var ap=0,am=ao[al].length;ap<am;ap++){if(ao[al].options[ap].selected){au.push(ao[al].options[ap].value);}}ar[aq]=au;}else{ar[aq]=ao[al].options[ao[al].selectedIndex].value;}}break;default:if(typeof(ao[al].innerHTML)!=="undefined"){ar[aq]=ao[al].innerHTML;}break;}}}return ar;};this.takeTemplate=function(){return ak(c.TEMPLATE);};this.take=function(){return ak(c.PROPERTY);};var aj=null;this.put=function(aB){var aq=r(S);if(aj===null){aj=aq.cloneNode(true);}else{var aG=aq.parentNode;aG.removeChild(aq);aq=aj.cloneNode(true);aG.appendChild(aq);}if(aq!==null){var aL=aq.querySelectorAll("["+c.TEMPLATE+"]");var aH=[];if(aL.length>0){for(var aK=0,aM=aL.length;aK<aM;aK++){var au=aL[aK].getAttribute(c.TEMPLATE);if(aa(au)==="*"){aH.push(aL[aK]);}else{var aw=au.split(",");H(aB,aL[aK],aw);}}}for(var aF in aB){if(aB.hasOwnProperty(aF)){if(typeof(aB[aF])!==ab){for(var an=0,ao=aH.length;an<ao;an++){var at=aH[an].innerHTML;aH[an].innerHTML=O("{"+aF+"}",(typeof aB[aF]===q)?aB[aF]():aB[aF],at);}var av=aq.querySelectorAll("["+c.PROPERTY+"="+aF+"]");if(typeof av!==ab&&av.length>0){for(var ay=0,aD=av.length;ay<aD;ay++){var ax="";var ar=(typeof aB[aF]===q)?aB[aF]():aB[aF];if(av[ay].getAttribute("bloq-format")){ax=av[ay].getAttribute("bloq-format");ar=p(ar,ax);}switch(av[ay].tagName.toLowerCase()){case T.TEXT_AREA:case T.INPUT:if(av[ay].type.toLowerCase()===T.RADIO){for(var aI=0,aJ=av.length;aI<aJ;aI++){if(av[aI].value.toLowerCase()===ar.toLowerCase()){av[aI].checked=true;}}}else{av[ay].value=ar;}break;case T.SELECT:if(aB[aF].constructor!==Array){for(var aE=0,aC=av[0].length;aE<aC;aE++){if(av[ay].options[aE].value.toLowerCase()===ar.toLowerCase()){av[ay].options[aE].selected=true;}}}else{for(var az=0,aA=aB[aF].length;az<aA;az++){for(var al=0,ap=av[ay].length;al<ap;al++){if(av[ay].options[al].value.toLowerCase()===ar.toLowerCase()){av[ay].options[al].selected=true;}}}}break;default:if(typeof(av[ay].innerHTML)!==ab){av[ay].innerHTML=ar;}break;}}}}}}}return this;};};var h=function(ai){return new o(ai);};h.extend=function(ai){for(var aj in ai){if(ai.hasOwnProperty(aj)){if(typeof(ai[aj])!==ab){h[aj]=ai[aj];}}}};h.extend(g);if(!u.bloq){u.bloq=u.bloq=h;}})(window);